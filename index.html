<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Monitoring Dumbbell</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome untuk ikon -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Animate.css untuk animasi -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css">
    <!-- Preconnect untuk meningkatkan performa loading -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/form-enhancement.css">
    <link rel="stylesheet" href="css/settings-enhancement.css">
    <script src="js/page-navigation.js" defer></script>
    <script src="js/forms.js" defer></script>
    <script src="js/settings.js" defer></script>
    <script src="js/debug.js"></script>

</head>
<body data-theme="dark">
    <!-- Overlay untuk mobile menu -->
    <div class="sidebar-overlay" id="sidebar-overlay"></div>
    
    <!-- Mobile Menu Toggle Button -->
    <button class="mobile-menu-toggle" id="mobile-menu-toggle">
        <i class="fas fa-bars"></i>
    </button>

    <div class="container-fluid">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header animate__animated animate__fadeIn">
                <i class="fas fa-dumbbell me-2"></i> Dumbbell Fitness
            </div>
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a class="nav-link active" href="#" data-target="dashboard">
                        <i class="fas fa-tachometer-alt"></i> Dashboard
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" data-target="details">
                        <i class="fas fa-list-alt"></i> Detail Latihan
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" data-target="add-data">
                        <i class="fas fa-plus-circle"></i> Tambah Data
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" data-target="profile">
                        <i class="fas fa-user"></i> Profil
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" data-target="settings">
                        <i class="fas fa-cog"></i> Pengaturan
                    </a>
                </li>
                <li class="nav-item mt-auto">
                    <a class="nav-link text-danger" href="#" id="logout-btn">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </a>
                </li>
            </ul>
        </div>

        <!-- Main Content -->
        <main>
            <div class="main-header animate__animated animate__fadeInDown">
                <h1 class="main-title"><i class="fas fa-dumbbell me-2"></i>Dashboard Latihan Dumbbell</h1>
                <div class="user-info">
                    <i class="fas fa-user-circle me-2"></i>
                    <span id="user-name">Selamat datang, User</span>
                    <a href="#" class="ms-3" id="logout-btn">
                        <i class="fas fa-sign-out-alt fa-lg"></i>
                    </a>
                </div>
            </div>

            <!-- Pages Container -->
            <div class="pages-container">
                <!-- Dashboard Page -->
                <div class="page active" id="dashboard">
                    <!-- Date Range Picker -->
                    <div class="date-range-picker animate__animated animate__fadeIn">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Rentang Tanggal:</span>
                        <input type="date" id="start-date" class="date-input">
                        <span class="separator">â€”</span>
                        <input type="date" id="end-date" class="date-input">
                        
                        <div class="workout-focus">
                            <i class="fas fa-dumbbell"></i>
                            <span>Fokus Latihan: Bicep Curl</span>
                        </div>
                        
                        <!-- Tombol refresh untuk chart -->
                        <button class="btn btn-refresh ms-2" id="refresh-charts">
                            <i class="fas fa-sync-alt"></i> Refresh Data
                        </button>
                    </div>

                    <!-- Dashboard Content -->
                    <div class="dashboard-container">
                        <!-- Charts Section -->
                        <div class="charts-container">
                            <div class="chart-row animate__animated animate__fadeInUp animate__delay-1s">
                                <!-- Duration Chart -->
                                <div class="chart-container">
                                    <div class="chart-header">
                                        <h3 class="chart-title">Durasi Waktu Latihan</h3>
                                        <i class="fas fa-clock chart-icon"></i>
                                    </div>
                                    <div class="chart-body">
                                        <canvas id="durationChart"></canvas>
                                    </div>
                                </div>
                                
                                <!-- Calories Chart -->
                                <div class="chart-container">
                                    <div class="chart-header">
                                        <h3 class="chart-title">Total Kalori Terbakar</h3>
                                        <i class="fas fa-fire-alt chart-icon"></i>
                                    </div>
                                    <div class="chart-body">
                                        <canvas id="caloriesChart"></canvas>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="reps-chart-container animate__animated animate__fadeInUp animate__delay-2s">
                                <!-- Reps Chart -->
                                <div class="reps-chart-wrapper">
                                    <div class="chart-header">
                                        <h3 class="chart-title">Total Repetisi</h3>
                                        <i class="fas fa-redo chart-icon"></i>
                                    </div>
                                    <div class="chart-body">
                                        <canvas id="repsChart"></canvas>
                                    </div>
                                </div>
                                
                                <!-- Statistics Summary -->
                                <div class="stats-summary-wrapper">
                                    <h3><i class="fas fa-chart-pie me-2"></i>Ringkasan Statistik</h3>
                                    <div class="stats-grid">
                                        <div class="stat-item">
                                            <div class="stat-label">STREAK</div>
                                            <div class="stat-value" id="total-streak">0<span class="stat-unit">ðŸ”¥</span></div>
                                        </div>
                                        <div class="stat-item">
                                            <div class="stat-label">Total Kalori</div>
                                            <div class="stat-value" id="total-calories">0<span class="stat-unit">kkal</span></div>
                                        </div>
                                        <div class="stat-item">
                                            <div class="stat-label">Total Durasi</div>
                                            <div class="stat-value" id="total-duration">0<span class="stat-unit">min</span></div>
                                        </div>
                                        <div class="stat-item">
                                            <div class="stat-label">Total Repetisi</div>
                                            <div class="stat-value" id="total-reps">0</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Metrics & Statistics -->
                        <div class="metrics-container animate__animated animate__fadeInRight animate__delay-3s">
                            <!-- Duration Metric -->
                            <div class="metric-card">
                                <div class="icon-circle">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <div class="label">Durasi Mengangkat Beban Terakhir</div>
                                <div class="value">
                                    <span id="current-duration">0</span>
                                    <span class="unit">menit</span>
                                </div>
                                <div class="trend animate-pulse">
                                    <i class="fas fa-arrow-up animate-bounce"></i> <span id="duration-trend">0%</span>
                                </div>
                            </div>
                            
                            <!-- Weight Metric -->
                            <div class="metric-card">
                                <div class="icon-circle">
                                    <i class="fas fa-weight-hanging"></i>
                                </div>
                                <div class="label">Total Angkatan Beban Terakhir</div>
                                <div class="value">
                                    <span id="current-weight">0</span>
                                    <span class="unit">kg</span>
                                </div>
                                <div class="trend animate-pulse">
                                    <i class="fas fa-arrow-up animate-bounce"></i> <span id="weight-trend">0%</span>
                                </div>
                            </div>
                            
                            <!-- Reps Metric -->
                            <div class="metric-card">
                                <div class="icon-circle">
                                    <i class="fas fa-redo"></i>
                                </div>
                                <div class="label">Total Repetisi Terakhir</div>
                                <div class="value">
                                    <span id="current-reps">0</span>
                                    <span class="unit">reps</span>
                                </div>
                                <div class="trend animate-pulse">
                                    <i class="fas fa-arrow-up animate-bounce"></i> <span id="reps-trend">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Details Page -->
                <div class="page" id="details">
                    <div class="page-header animate__animated animate__fadeIn">
                        <h2 class="page-title"><i class="fas fa-list-alt me-2"></i>Detail Latihan Harian</h2>
                    </div>
                    
                    <div class="detail-table-container animate__animated animate__fadeInUp">
                        <table class="detail-table">
                            <thead>
                                <tr>
                                    <th>TANGGAL</th>
                                    <th>LATIHAN</th>
                                    <th>BERAT (KG)</th>
                                    <th>SET</th>
                                    <th>REPETISI</th>
                                    <th>DURASI (MENIT)</th>
                                    <th>KALORI (KKAL)</th>
                                    <th>AKSI</th>
                                </tr>
                            </thead>
                            <tbody id="details-table-body">
                                <!-- Data akan diisi dari JavaScript -->
                                <tr>
                                    <td colspan="8" class="text-center">Loading data...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div id="pagination" class="d-flex justify-content-center mt-3">
                        <!-- Pagination akan diisi dari JavaScript -->
                    </div>
                    
                    <div class="mt-4 animate__animated animate__fadeIn animate__delay-1s">
                        <button type="button" class="btn btn-primary me-3" id="export-csv">
                            <i class="fas fa-file-csv me-2"></i> Export CSV
                        </button>
                        <button type="button" class="btn btn-primary" id="export-pdf">
                            <i class="fas fa-file-pdf me-2"></i> Export PDF
                        </button>
                    </div>
                </div>

                <!-- Add Data Page -->
                <div class="page" id="add-data">
                    <div class="page-header animate__animated animate__fadeIn">
                        <h2 class="page-title"><i class="fas fa-plus-circle me-2"></i>Tambah Data Latihan Bicep Curl</h2>
                    </div>
                    
                    <div class="content-card animate__animated animate__fadeInUp">
                        <form id="add-workout-form">
                            <div class="form-row">
                                <div class="form-input-container">
                                    <label for="input-reps" class="form-label">Jumlah Repetisi</label>
                                    <div class="input-with-icon">
                                        <i class="fas fa-redo input-icon"></i>
                                        <input type="number" 
                                               id="input-reps" 
                                               name="reps"
                                               class="dark-input" 
                                               placeholder="Masukkan jumlah repetisi" 
                                               min="1" 
                                               required>
                                        <button type="button" class="clear-btn"><i class="fas fa-times"></i></button>
                                    </div>
                                </div>
                                <div class="form-input-container">
                                    <label for="input-sets" class="form-label">Jumlah Set</label>
                                    <div class="input-with-icon">
                                        <i class="fas fa-layer-group input-icon"></i>
                                        <input type="number" 
                                               id="input-sets" 
                                               name="sets"
                                               class="dark-input" 
                                               placeholder="Masukkan jumlah set" 
                                               min="1" 
                                               value="1" 
                                               required>
                                        <button type="button" class="clear-btn"><i class="fas fa-times"></i></button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-input-container">
                                    <label for="input-weight" class="form-label">Berat (kg)</label>
                                    <div class="input-with-icon">
                                        <i class="fas fa-weight-hanging input-icon"></i>
                                        <input type="number" 
                                               id="input-weight" 
                                               name="weight"
                                               class="dark-input" 
                                               placeholder="Masukkan berat (kg)" 
                                               min="0" 
                                               step="0.5" 
                                               required>
                                        <button type="button" class="clear-btn"><i class="fas fa-times"></i></button>
                                    </div>
                                </div>
                                <div class="form-input-container">
                                    <label for="input-duration" class="form-label">Durasi (menit)</label>
                                    <div class="input-with-icon">
                                        <i class="fas fa-clock input-icon"></i>
                                        <input type="number" 
                                               id="input-duration" 
                                               name="duration"
                                               class="dark-input" 
                                               placeholder="Masukkan durasi (menit)" 
                                               min="1" 
                                               required>
                                        <button type="button" class="clear-btn"><i class="fas fa-times"></i></button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-input-container">
                                    <label for="input-date" class="form-label">Tanggal dan Waktu</label>
                                    <div class="input-with-icon">
                                        <i class="fas fa-calendar-alt input-icon"></i>
                                        <input type="datetime-local" 
                                               id="input-date" 
                                               name="workout_date"
                                               class="dark-input" 
                                               required>
                                        <button type="button" class="clear-btn"><i class="fas fa-times"></i></button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-actions">
                                <button type="submit" class="btn-save">
                                    <i class="fas fa-save"></i> Simpan Data
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Profile Page -->
                <div class="page" id="profile">
                    <div class="page-header animate__animated animate__fadeIn">
                        <h2 class="page-title"><i class="fas fa-user me-2"></i>Profil Pengguna</h2>
                    </div>
                    
                    <div class="profile-container animate__animated animate__fadeInUp">
                        <div class="profile-header">
                            <div class="profile-avatar">
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="profile-info">
                                <h2 class="profile-name">User Name</h2>
                                <p class="profile-email">user@example.com</p>
                                <div class="profile-stats">
                                    <div class="profile-stat">
                                        <div class="profile-stat-value">24</div>
                                        <div class="profile-stat-label">Total Latihan</div>
                                    </div>
                                    <div class="profile-stat">
                                        <div class="profile-stat-value">12,500 kg</div>
                                        <div class="profile-stat-label">Total Beban</div>
                                    </div>
                                    <div class="profile-stat">
                                        <div class="profile-stat-value">8,700 kkal</div>
                                        <div class="profile-stat-label">Total Kalori</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Workout Progress Section -->
                        <div class="workout-progress-section mt-5 animate__animated animate__fadeIn animate__delay-1s">
                            <h3 class="section-title"><i class="fas fa-chart-line me-2"></i>Progres Latihan</h3>
                            <div class="progress-card-container">
                                <div class="progress-card">
                                    <div class="progress-header">
                                        <i class="fas fa-dumbbell me-2"></i>
                                        <span>Berat Terangkat</span>
                                    </div>
                                    <div class="progress-value">+15%</div>
                                    <div class="progress-description">Meningkat dari minggu sebelumnya</div>
                                </div>
                                
                                <div class="progress-card">
                                    <div class="progress-header">
                                        <i class="fas fa-stopwatch me-2"></i>
                                        <span>Durasi Rata-rata</span>
                                    </div>
                                    <div class="progress-value">24 min</div>
                                    <div class="progress-description">Per sesi latihan</div>
                                </div>
                                
                                <div class="progress-card">
                                    <div class="progress-header">
                                        <i class="fas fa-fire-alt me-2"></i>
                                        <span>Kalori Terbakar</span>
                                    </div>
                                    <div class="progress-value">4,500</div>
                                    <div class="progress-description">Dalam 30 hari terakhir</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Settings Page -->
                <div class="page" id="settings">
                    <div class="page-header animate__animated animate__fadeIn">
                        <h2 class="page-title"><i class="fas fa-cog me-2"></i>Pengaturan</h2>
                    </div>
                    
                    <div class="content-card animate__animated animate__fadeInUp">
                        <h3 class="settings-section-title"><i class="fas fa-palette me-2"></i>Tema Aplikasi</h3>
                        <div class="theme-options">
                            <div class="theme-option-container">
                                <button class="theme-btn theme-default" data-theme="default">
                                    Default
                                </button>
                                <button class="theme-btn theme-dark active" data-theme="dark">
                                    Dark
                                </button>
                                <button class="theme-btn theme-blue" data-theme="blue">
                                    Blue
                                </button>
                            </div>
                        </div>
                        
                        <h3 class="settings-section-title mt-5"><i class="fas fa-bell me-2"></i>Notifikasi</h3>
<!-- Form Input Berat (hidden by default) -->
                        <div id="weight-form">
                            <h4 class="form-title mb-4">Input Berat Dumbbell</h4>
                            <form id="set-weight-form">
                                <div class="mb-3">
                                    <label for="dumbbell-weight" class="form-label">Berat Dumbbell (kg)</label>
                                    <div class="input-with-icon">
                                        <input type="number" step="0.5" min="0.5" max="50" class="form-control with-icon" id="dumbbell-weight" placeholder="Masukkan berat dumbbell" required>
                                        <i class="fas fa-weight-hanging input-icon"></i>
                                    </div>
                                </div>
                                <button type="submit" class="btn btn-primary mt-3">
                                    <i class="fas fa-play-circle"></i> Mulai Latihan
                                </button>
                            </form>
                        </div>
                        
                        <h3 class="settings-section-title mt-5"><i class="fas fa-shield-alt me-2"></i>Keamanan</h3>
                        <div class="security-settings">
                            <button type="button" class="btn btn-primary">
                                <i class="fas fa-key me-2"></i>Ubah Kata Sandi
                            </button>
                            <button type="button" class="btn btn-primary ms-3">
                                <i class="fas fa-download me-2"></i>Ekspor Data
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Toast Notification Container -->
    <div id="toast-container"></div>

    <!-- Modal for Editing -->
    <div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editModalLabel">Edit Data Latihan</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="edit-workout-form">
                        <input type="hidden" id="edit-id">
                        <div class="mb-3">
                            <label for="edit-reps" class="form-label">Jumlah Repetisi</label>
                            <div class="input-with-icon">
                                <i class="fas fa-redo input-icon"></i>
                                <input type="number" class="form-control" id="edit-reps" min="1" required>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="edit-sets" class="form-label">Jumlah Set</label>
                            <div class="input-with-icon">
                                <i class="fas fa-layer-group input-icon"></i>
                                <input type="number" class="form-control" id="edit-sets" min="1" required>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="edit-weight" class="form-label">Berat (kg)</label>
                            <div class="input-with-icon">
                                <i class="fas fa-weight-hanging input-icon"></i>
                                <input type="number" class="form-control" id="edit-weight" min="0" step="0.5" required>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="edit-duration" class="form-label">Durasi (menit)</label>
                            <div class="input-with-icon">
                                <i class="fas fa-clock input-icon"></i>
                                <input type="number" class="form-control" id="edit-duration" min="1" required>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="edit-calories" class="form-label">Kalori</label>
                            <div class="input-with-icon">
                                <i class="fas fa-fire-alt input-icon"></i>
                                <input type="number" class="form-control" id="edit-calories" min="0" required>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="edit-date" class="form-label">Tanggal dan Waktu</label>
                            <div class="input-with-icon">
                                <i class="fas fa-calendar-alt input-icon"></i>
                                <input type="datetime-local" class="form-control" id="edit-date" required>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-primary" id="save-edit">
                        <i class="fas fa-save me-2"></i>Simpan
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    
    <!-- Custom JavaScript -->
    <script src="js/config.js"></script>
    <script src="js/charts.js"></script>
    <script src="js/main.js"></script>
    <script src="js/rfid_handler.js"></script>
    <script src="js/theme.js"></script>
    
    <!-- Custom Script for Dynamic UI Enhancement -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Mobile menu toggle
            const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
            const sidebar = document.querySelector('.sidebar');
            const sidebarOverlay = document.getElementById('sidebar-overlay');
            
            if (mobileMenuToggle) {
                mobileMenuToggle.addEventListener('click', function() {
                    sidebar.classList.toggle('show');
                    sidebarOverlay.classList.toggle('show');
                });
            }
            
            if (sidebarOverlay) {
                sidebarOverlay.addEventListener('click', function() {
                    sidebar.classList.remove('show');
                    sidebarOverlay.classList.remove('show');
                });
            }
            
            // Logout button handler
            document.querySelectorAll('#logout-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    // Show confirmation dialog
                    if (confirm('Apakah Anda yakin ingin keluar?')) {
                        // Animate before logout
                        document.querySelector('main').classList.add('animate__animated', 'animate__fadeOut');
                        
                        // Handle logout after animation
                        setTimeout(function() {
                            // Menghapus data pengguna dari localStorage
                            localStorage.removeItem('current_user');
                            localStorage.removeItem('current_rfid');
                            localStorage.removeItem('current_session');
                            
                            // Redirect ke halaman login setelah logout
                            window.location.href = 'login.html'; 
                        }, 500);
                    }
                });
            });
            
            // Enhance input fields with icon support
            document.querySelectorAll('.input-with-icon').forEach(container => {
                const input = container.querySelector('input');
                const icon = container.querySelector('.input-icon');
                
                if (input && icon) {
                    // Focus effect
                    input.addEventListener('focus', () => {
                        icon.classList.add('input-icon-active');
                        container.classList.add('input-focused');
                    });
                    
                    // Blur effect
                    input.addEventListener('blur', () => {
                        icon.classList.remove('input-icon-active');
                        container.classList.remove('input-focused');
                    });
                    
                    // Add animations when typing
                    input.addEventListener('input', () => {
                        if (input.value.length > 0) {
                            container.classList.add('has-value');
                        } else {
                            container.classList.remove('has-value');
                        }
                    });
                }
            });
            
            // Refresh button animation
            const refreshBtn = document.getElementById('refresh-charts');
            if (refreshBtn) {
                refreshBtn.addEventListener('click', function() {
                    const icon = this.querySelector('i');
                    // Add rotation animation
                    icon.style.transition = 'transform 0.8s ease';
                    icon.style.transform = 'rotate(360deg)';
                    
                    // Reset after animation
                    setTimeout(() => {
                        icon.style.transition = 'none';
                        icon.style.transform = 'rotate(0deg)';
                        
                        // Re-enable transition after reset
                        setTimeout(() => {
                            icon.style.transition = 'transform 0.8s ease';
                        }, 50);
                    }, 800);
                });
            }
            
            // Calculate and update progress trends
            function updateTrends() {
                // Get current values
                const currentDuration = parseInt(document.getElementById('current-duration').textContent) || 0;
                const currentWeight = parseFloat(document.getElementById('current-weight').textContent) || 0;
                const currentReps = parseInt(document.getElementById('current-reps').textContent) || 0;
                
                // Generate realistic trend values (simulating trends from previous data)
                const durationTrend = (Math.random() * 20 - 5).toFixed(1);
                const weightTrend = (Math.random() * 15).toFixed(1);
                const repsTrend = (Math.random() * 25 - 2).toFixed(1);
                
                // Update trend displays
                document.getElementById('duration-trend').textContent = 
                    (durationTrend > 0 ? '+' : '') + durationTrend + '%';
                document.getElementById('weight-trend').textContent = 
                    (weightTrend > 0 ? '+' : '') + weightTrend + '%';
                document.getElementById('reps-trend').textContent = 
                    (repsTrend > 0 ? '+' : '') + repsTrend + '%';
                
                // Update trend icons based on values
                updateTrendIcon('duration-trend', durationTrend);
                updateTrendIcon('weight-trend', weightTrend);
                updateTrendIcon('reps-trend', repsTrend);
            }
            
            function updateTrendIcon(elementId, trendValue) {
                const trendElement = document.getElementById(elementId);
                if (!trendElement) return;
                
                const iconElement = trendElement.previousElementSibling;
                if (!iconElement) return;
                
                // Reset classes
                iconElement.className = '';
                
                // Add appropriate icon and color
                if (trendValue > 0) {
                    iconElement.classList.add('fas', 'fa-arrow-up', 'animate-bounce');
                    trendElement.parentElement.style.color = 'var(--success-color)';
                    trendElement.parentElement.style.backgroundColor = 'rgba(16, 185, 129, 0.1)';
                } else if (trendValue < 0) {
                    iconElement.classList.add('fas', 'fa-arrow-down', 'animate-bounce');
                    trendElement.parentElement.style.color = 'var(--danger-color)';
                    trendElement.parentElement.style.backgroundColor = 'rgba(239, 68, 68, 0.1)';
                } else {
                    iconElement.classList.add('fas', 'fa-equals');
                    trendElement.parentElement.style.color = 'var(--light-text)';
                    trendElement.parentElement.style.backgroundColor = 'rgba(107, 114, 128, 0.1)';
                }
            }
            
            // Run trend update on load
            updateTrends();
            
            // Update progress cards in profile page (mock data for demonstration)
            function updateProgressCards() {
                const page = document.querySelector('#profile');
                if (!page) return;
                
                // Update progress values with realistic data
                const progressValues = document.querySelectorAll('.progress-value');
                if (progressValues.length >= 3) {
                    // Random weight progress between 5% and 25%
                    const weightProgress = (Math.random() * 20 + 5).toFixed(1);
                    progressValues[0].textContent = '+' + weightProgress + '%';
                    
                    // Random duration between 15 and 45 minutes
                    const avgDuration = Math.floor(Math.random() * 30 + 15);
                    progressValues[1].textContent = avgDuration + ' min';
                    
                    // Random calories between 3500 and 6500
                    const totalCalories = Math.floor(Math.random() * 3000 + 3500);
                    progressValues[2].textContent = totalCalories.toLocaleString('id-ID');
                }
            }
            
            // Update progress cards when profile page is shown
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function() {
                    if (this.getAttribute('data-target') === 'profile') {
                        setTimeout(updateProgressCards, 500);
                    }
                });
            });
            
            // Helper function to show toast notifications
            window.showToast = function(message, type = 'info') {
                const toastContainer = document.getElementById('toast-container');
                if (!toastContainer) return;
                
                // Create toast element
                const toast = document.createElement('div');
                toast.className = `toast toast-${type}`;
                
                // Set icon based on toast type
                let icon = 'info-circle';
                let title = 'Informasi';
                
                if (type === 'success') {
                    icon = 'check-circle';
                    title = 'Sukses';
                } else if (type === 'error') {
                    icon = 'exclamation-circle';
                    title = 'Error';
                } else if (type === 'warning') {
                    icon = 'exclamation-triangle';
                    title = 'Peringatan';
                }
                
                // Create toast content
                toast.innerHTML = `
                    <div class="toast-header">
                        <i class="fas fa-${icon} me-2"></i>
                        <strong>${title}</strong>
                        <button type="button" class="toast-close">&times;</button>
                    </div>
                    <div class="toast-body">${message}</div>
                `;
                
                // Add to container
                toastContainer.appendChild(toast);
                
                // Show after a small delay (for animation)
                setTimeout(() => {
                    toast.classList.add('show');
                }, 10);
                
                // Close button event
                toast.querySelector('.toast-close').addEventListener('click', function() {
                    closeToast(toast);
                });
                
                // Auto close after 5 seconds
                setTimeout(() => closeToast(toast), 5000);
            }
            
            function closeToast(toast) {
                toast.classList.remove('show');
                setTimeout(() => {
                    toast.remove();
                }, 300);
            }
            
            // Add CSS for enhanced input fields
            const style = document.createElement('style');
            style.textContent = `
                .input-with-icon {
                    position: relative;
                }
                
                .input-icon {
                    position: absolute;
                    left: 12px;
                    top: 50%;
                    transform: translateY(-50%);
                    color: var(--light-text);
                    transition: all 0.3s ease;
                    z-index: 2;
                }
                
                .input-icon-active {
                    color: var(--primary-color);
                    transform: translateY(-50%) scale(1.1);
                }
                
                .dark-input, .form-control {
                    padding-left: 40px !important;
                }
                
                .input-focused .dark-input, 
                .input-focused .form-control {
                    border-color: var(--primary-color);
                    box-shadow: 0 0 0 3px var(--primary-color-light);
                }
                
                /* Profile page progress cards */
                .section-title {
                    font-size: 1.4rem;
                    font-weight: 600;
                    margin-bottom: 1.5rem;
                    padding-bottom: 0.5rem;
                    border-bottom: 1px solid var(--border-color);
                    color: var(--text-color);
                }
                
                .progress-card-container {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                    gap: 1.5rem;
                }
                
                .progress-card {
                    background-color: var(--card-bg);
                    border-radius: 12px;
                    padding: 1.5rem;
                    box-shadow: var(--shadow);
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    text-align: center;
                    transition: var(--transition-normal);
                    border: 1px solid transparent;
                }
                
                .progress-card:hover {
                    transform: translateY(-5px);
                    box-shadow: var(--shadow-lg);
                    border-color: var(--primary-color-light);
                }
                
                .progress-header {
                    font-weight: 500;
                    color: var(--light-text);
                    margin-bottom: 1rem;
                    font-size: 1rem;
                    text-transform: uppercase;
                    letter-spacing: 0.5px;
                }
                
                .progress-value {
                    font-size: 2.2rem;
                    font-weight: bold;
                    color: var(--primary-color);
                    margin-bottom: 0.5rem;
                }
                
                .progress-description {
                    color: var(--light-text);
                    font-size: 0.9rem;
                }
                
                /* Settings page styles */
                .settings-section-title {
                    font-size: 1.2rem;
                    font-weight: 600;
                    margin-bottom: 1.25rem;
                    color: var(--text-color);
                }
                
                .notification-settings {
                    display: flex;
                    flex-direction: column;
                    gap: 1rem;
                    margin-bottom: 1.5rem;
                }
                
                .form-check-input {
                    background-color: rgba(255, 255, 255, 0.2);
                    border-color: var(--border-color);
                    width: 2.5rem;
                    height: 1.25rem;
                }
                
                .form-check-input:checked {
                    background-color: var(--primary-color);
                    border-color: var(--primary-color);
                }
                
                .form-check-label {
                    color: var(--text-color);
                    font-weight: 500;
                }
                
                .security-settings {
                    display: flex;
                    flex-wrap: wrap;
                    gap: 1rem;
                }
            `;
            
            document.head.appendChild(style);
            
            // Show welcome toast
            setTimeout(() => {
                showToast('Selamat datang di Dashboard Fitness Monitoring Dumbbell! ðŸ’ª', 'success');
            }, 1000);
        });
    </script>
</body>
<script>
    // Debugging script untuk memeriksa status data
    document.addEventListener('DOMContentLoaded', function() {
        // Log sesi dan user info
        console.log("DEBUG SESSION INFO:");
        console.log("current_session:", localStorage.getItem('current_session'));
        console.log("current_user_id:", localStorage.getItem('current_user_id'));
        
        // Log semua item localStorage
        console.log("All localStorage items:");
        for (let i = 0; i < localStorage.length; i++) {
            const key = localStorage.key(i);
            console.log(`${key}: ${localStorage.getItem(key)}`);
        }
        
        // Log workout data jika ada
        const workoutData = localStorage.getItem('workout_sessions');
        if (workoutData) {
            try {
                console.log("Parsed workout data:", JSON.parse(workoutData));
            } catch(e) {
                console.error("Error parsing workout data:", e);
                console.log("Raw workout data:", workoutData);
            }
        } else {
            console.warn("No workout data found in localStorage");
        }
        
        // Check chart canvas elements
        console.log("Chart canvas elements:");
        console.log("durationChart:", document.getElementById('durationChart'));
        console.log("caloriesChart:", document.getElementById('caloriesChart')); 
        console.log("repsChart:", document.getElementById('repsChart'));
        
        // Force refresh charts after 2 seconds
        setTimeout(function() {
            console.log("Forcing chart refresh...");
            if (typeof window.refreshCharts === 'function') {
                window.refreshCharts();
            } else {
                console.error("refreshCharts function not found!");
            }
        }, 2000);
    });
    </script>